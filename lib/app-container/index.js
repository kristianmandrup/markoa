'use strict';

// new appContainer(koaApp)
module.exports = function(koaApp) {
  if (!koaApp)
    throw 'AppContainer constructor must take a koaApp as argument';

  let Mounter = require('./mounter');
  let Routes = require('./routes');

  let appContainer = {
    koaApp: koaApp,
    apps: [],
    state: {
      $global: {}
    },
    // A koaApp is generated by calling koa() which creates a Koa server app instance
    start: function() {
      this.koaApp.koaServer.start();
      return this;
    },
    Mounter: Mounter,
    Routes: Routes
  };
  appContainer.routes = new Routes(appContainer, koaApp);
  appContainer.mount = new Mounter(appContainer);
  return appContainer;
}
